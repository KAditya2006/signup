<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Farmer Portal</title>
	<style>
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			background: linear-gradient(135deg, #74ebd5, #acb6e5);
			margin: 0;
			min-height: 100vh;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		.container,
		.login-container,
		.register-container,
		.profile-container {
			background: white;
			border-radius: 15px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
			padding: 30px;
			width: 90%;
			max-width: 600px;
			display: none;
			flex-direction: column;
			align-items: center;
		}

		.active {
			display: flex;
		}

		h2 {
			margin-bottom: 20px;
			color: #333;
		}

		input,
		select {
			width: 90%;
			padding: 10px;
			margin: 10px 0;
			border: 1px solid #ccc;
			border-radius: 8px;
			font-size: 14px;
		}

		button,
		.btn,
		.edit-btn {
			width: 100%;
			padding: 12px;
			margin-top: 10px;
			border: none;
			border-radius: 8px;
			font-size: 16px;
			cursor: pointer;
			color: white;
		}

		.login-btn {
			background: #4caf50;
		}

		.login-btn:hover {
			background: #45a049;
		}

		.register-btn {
			background: #ff6f61;
		}

		.register-btn:hover {
			background: #e65b4f;
		}

		.edit-btn {
			background: #4caf50;
			margin-top: 20px;
		}

		.edit-btn:hover {
			background: #388e3c;
		}

		.btn {
			background: #2e7d32;
		}

		.btn:hover {
			background: #256428;
		}

		#logoutBtn {
			background: #d32f2f;
		}

		#logoutBtn:hover {
			background: #b71c1c;
		}

		p {
			font-size: 14px;
		}

		a {
			cursor: pointer;
			color: #4caf50;
		}

		.profile-card {
			width: 100%;
			text-align: left;
		}

		.header {
			display: flex;
			align-items: center;
			border-bottom: 2px solid #eee;
			padding-bottom: 15px;
		}

		.header img {
			width: 90px;
			height: 90px;
			border-radius: 50%;
			border: 3px solid #4caf50;
			margin-right: 20px;
			object-fit: cover;
		}

		.header h2 {
			margin: 0;
			font-size: 24px;
			color: #2e7d32;
		}

		.header p {
			margin: 5px 0 0;
			color: #666;
		}

		.section {
			margin-top: 20px;
		}

		.section h3 {
			font-size: 20px;
			margin-bottom: 10px;
			color: #388e3c;
		}

		.info-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 15px;
		}

		.info-item {
			background: #f9fdfb;
			padding: 12px 15px;
			border-radius: 10px;
			border: 1px solid #e0e0e0;
		}

		.info-item strong {
			display: block;
			font-size: 14px;
			color: #555;
			margin-bottom: 5px;
		}

		.success {
			color: green;
			text-align: center;
			margin-top: 10px;
			display: none;
		}
	</style>
</head>

<body>
	<!-- Login -->
	<div class="login-container" id="loginContainer">
		<h2>Login</h2>
		<form id="loginForm">
			<input type="text" id="loginUsername" placeholder="Username or Email" required>
			<input type="password" id="loginPassword" placeholder="Password" required>
			<button type="submit" class="login-btn">Login</button>
		</form>
		<p>Don't have an account? <a id="goRegister">Register</a></p>
	</div>

	<!-- Register -->
	<div class="register-container" id="registerContainer">
		<h2>Create Account</h2>
		<form id="registerForm">
			<input type="text" id="username" placeholder="Full Name" required>
			<input type="email" id="email" placeholder="Email Address" required>
			<input type="password" id="password" placeholder="Password" required>
			<input type="password" id="confirmPassword" placeholder="Confirm Password" required>
			<button type="submit" class="register-btn">Register</button>
		</form>
		<p>Already have an account? <a id="goLogin">Login</a></p>
	</div>

	<!-- Profile -->
	<div class="container" id="profileContainer">
		<div class="profile-card">
			<div class="header">
				<img id="profilePhoto" src="https://via.placeholder.com/90" alt="Profile Photo">
				<div>
					<h2 id="profileName">Farmer</h2>
					<p id="profileId">Farmer ID: F0000</p>
				</div>
			</div>

			<div class="section">
				<h3>üë®‚Äçüåæ Personal Information</h3>
				<div class="info-grid">
					<div class="info-item"><strong>Age</strong>
						<p id="profileAge"></p>
					</div>
					<div class="info-item"><strong>Contact</strong>
						<p id="profileContact"></p>
					</div>
					<div class="info-item"><strong>Address</strong>
						<p id="profileAddress"></p>
					</div>
					<div class="info-item"><strong>Email</strong>
						<p id="profileEmail"></p>
					</div>
				</div>
			</div>

			<div class="section">
				<h3>üåæ Farm Details</h3>
				<div class="info-grid">
					<div class="info-item"><strong>Land Size</strong>
						<p id="profileLand"></p>
					</div>
					<div class="info-item"><strong>Soil Type</strong>
						<p id="profileSoil"></p>
					</div>
					<div class="info-item"><strong>Water Source</strong>
						<p id="profileWater"></p>
					</div>
					<div class="info-item"><strong>Region</strong>
						<p id="profileRegion"></p>
					</div>
				</div>
			</div>

			<div class="section">
				<h3>üìã Crop History</h3>
				<div class="info-grid">
					<div class="info-item"><strong>Last Season</strong>
						<p id="profileLastSeason"></p>
					</div>
					<div class="info-item"><strong>Next Planned Crop</strong>
						<p id="profileNextCrop"></p>
					</div>
				</div>
			</div>

			<div class="section">
				<h3>üåê Language Preference</h3>
				<p id="profileLanguage"></p>
			</div>

			<button class="edit-btn" onclick="openEditForm()">‚úèÔ∏è Edit Profile</button>
			<button class="btn" id="logoutBtn">üö™ Logout</button>
		</div>
	</div>

	<!-- Edit Profile -->
	<div class="profile-container" id="editFormContainer">
		<h2>üßë‚Äçüåæ Edit Farmer Profile</h2>
		<form id="profileForm">
			<label>Profile Photo</label>
			<input type="file" id="editPhoto" accept="image/*">

			<label>Full Name</label>
			<input type="text" id="editName" required>

			<label>Age</label>
			<input type="number" id="editAge" required>

			<label>Contact Number</label>
			<input type="tel" id="editContact" required>

			<label>Address</label>
			<input type="text" id="editAddress" required>

			<label>Email</label>
			<input type="email" id="editEmail">

			<label>Land Size</label>
			<input type="text" id="editLand">

			<label>Soil Type</label>
			<input type="text" id="editSoil">

			<label>Water Source</label>
			<input type="text" id="editWater">

			<label>Region</label>
			<input type="text" id="editRegion">

			<label>Last Season Crop</label>
			<input type="text" id="editLastSeason">

			<label>Next Planned Crop</label>
			<input type="text" id="editNextCrop">

			<label>Preferred Language</label>
			<select id="editLanguage">
				<option>English</option>
				<option>Hindi</option>
				<option>Bengali</option>
				<option>Marathi</option>
				<option>Punjabi</option>
			</select>

			<button type="submit" class="btn">Save Profile</button>
		</form>
		<p class="success" id="successMsg">‚úÖ Profile updated successfully!</p>
	</div>

	<script>
		const loginContainer = document.getElementById("loginContainer");
		const registerContainer = document.getElementById("registerContainer");
		const profileContainer = document.getElementById("profileContainer");
		const editFormContainer = document.getElementById("editFormContainer");

		const goLogin = document.getElementById("goLogin");
		const goRegister = document.getElementById("goRegister");
		const logoutBtn = document.getElementById("logoutBtn");

		let users = JSON.parse(localStorage.getItem("users")) || [];

		function showContainer(container) {
			loginContainer.style.display = "none";
			registerContainer.style.display = "none";
			profileContainer.style.display = "none";
			editFormContainer.style.display = "none";
			container.style.display = "flex";
		}

		goRegister.addEventListener("click", () => showContainer(registerContainer));
		goLogin.addEventListener("click", () => showContainer(loginContainer));

		// Register
		document.getElementById("registerForm").addEventListener("submit", function (e) {
			e.preventDefault();
			const username = document.getElementById("username").value;
			const email = document.getElementById("email").value;
			const password = document.getElementById("password").value;
			const confirmPassword = document.getElementById("confirmPassword").value;

			if (password !== confirmPassword) { alert("Passwords do not match!"); return; }
			if (password.length < 8) { alert("Password must be at least 8 characters"); return; }
			if (users.find(u => u.email === email)) { alert("This email is already registered!"); return; }

			users.push({ username, email, password });
			localStorage.setItem("users", JSON.stringify(users));
			alert("Registration successful!");
			showContainer(loginContainer);
		});

		// Login
		document.getElementById("loginForm").addEventListener("submit", function (e) {
			e.preventDefault();
			const uname = document.getElementById("loginUsername").value;
			const pass = document.getElementById("loginPassword").value;
			const user = users.find(u => (u.username === uname || u.email === uname) && u.password === pass);

			if (user) {
				localStorage.setItem("currentUser", JSON.stringify(user));
				showContainer(profileContainer);
				loadProfile();
			} else alert("Invalid credentials!");
		});

		// Logout
		logoutBtn.addEventListener("click", () => {
			localStorage.removeItem("currentUser");
			showContainer(loginContainer);
			alert("You have been logged out.");
		});

		// Profile Elements
		const profileElements = {
			photo: document.getElementById("profilePhoto"),
			name: document.getElementById("profileName"),
			age: document.getElementById("profileAge"),
			contact: document.getElementById("profileContact"),
			address: document.getElementById("profileAddress"),
			email: document.getElementById("profileEmail"),
			land: document.getElementById("profileLand"),
			soil: document.getElementById("profileSoil"),
			water: document.getElementById("profileWater"),
			region: document.getElementById("profileRegion"),
			lastSeason: document.getElementById("profileLastSeason"),
			nextCrop: document.getElementById("profileNextCrop"),
			language: document.getElementById("profileLanguage")
		};

		function loadProfile() {
			const currentUser = JSON.parse(localStorage.getItem("currentUser"));
			const profile = JSON.parse(localStorage.getItem("farmerProfile_" + currentUser.email)) || {};
			profileElements.name.innerText = profile.name || currentUser.username || "Farmer";
			profileElements.email.innerText = profile.email || currentUser.email || "";
			profileElements.age.innerText = profile.age ? profile.age + " Years" : "";
			profileElements.contact.innerText = profile.contact || "";
			profileElements.address.innerText = profile.address || "";
			profileElements.land.innerText = profile.land || "";
			profileElements.soil.innerText = profile.soil || "";
			profileElements.water.innerText = profile.water || "";
			profileElements.region.innerText = profile.region || "";
			profileElements.lastSeason.innerText = profile.lastSeason || "";
			profileElements.nextCrop.innerText = profile.nextCrop || "";
			profileElements.language.innerText = profile.language || "English";
			profileElements.photo.src = profile.photo || "https://via.placeholder.com/90";
		}

		function openEditForm() {
			showContainer(editFormContainer);
			const currentUser = JSON.parse(localStorage.getItem("currentUser"));
			const profile = JSON.parse(localStorage.getItem("farmerProfile_" + currentUser.email)) || {};
			document.getElementById("editName").value = profile.name || profileElements.name.innerText;
			document.getElementById("editAge").value = profile.age || "";
			document.getElementById("editContact").value = profile.contact || "";
			document.getElementById("editAddress").value = profile.address || "";
			document.getElementById("editEmail").value = profile.email || profileElements.email.innerText;
			document.getElementById("editLand").value = profile.land || "";
			document.getElementById("editSoil").value = profile.soil || "";
			document.getElementById("editWater").value = profile.water || "";
			document.getElementById("editRegion").value = profile.region || "";
			document.getElementById("editLastSeason").value = profile.lastSeason || "";
			document.getElementById("editNextCrop").value = profile.nextCrop || "";
			document.getElementById("editLanguage").value = profile.language || "English";
		}

		document.getElementById("profileForm").addEventListener("submit", function (e) {
			e.preventDefault();
			const fileInput = document.getElementById("editPhoto");
			let photoURL = profileElements.photo.src;
			if (fileInput.files && fileInput.files[0]) {
				const reader = new FileReader();
				reader.onload = function (e) { saveProfile(e.target.result); }
				reader.readAsDataURL(fileInput.files[0]);
			} else saveProfile(photoURL);
		});

		function saveProfile(photoURL) {
			const currentUser = JSON.parse(localStorage.getItem("currentUser"));
			const profile = {
				photo: photoURL,
				name: document.getElementById("editName").value,
				age: document.getElementById("editAge").value,
				contact: document.getElementById("editContact").value,
				address: document.getElementById("editAddress").value,
				email: document.getElementById("editEmail").value,
				land: document.getElementById("editLand").value,
				soil: document.getElementById("editSoil").value,
				water: document.getElementById("editWater").value,
				region: document.getElementById("editRegion").value,
				lastSeason: document.getElementById("editLastSeason").value,
				nextCrop: document.getElementById("editNextCrop").value,
				language: document.getElementById("editLanguage").value
			};
			localStorage.setItem("farmerProfile_" + currentUser.email, JSON.stringify(profile));
			loadProfile();
			document.getElementById("successMsg").style.display = "block";
			setTimeout(() => {
				document.getElementById("successMsg").style.display = "none";
				showContainer(profileContainer);
			}, 2000);
		}

		// On page load
		document.addEventListener("DOMContentLoaded", function () {
			if (localStorage.getItem("currentUser")) {
				showContainer(loginContainer); // Always show login first
			} else {
				showContainer(loginContainer);
			}
		});
	</script>
</body>

</html>